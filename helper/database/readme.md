# Менеджер работ с базами данных 
Библиотека реализует первые два из четырёх шагов концепции оформления результатов типовой метрологической работы: поиск в собственной базе и загрузка из неё шаблона Excel для обработки данных по конкретному средству измерений (шаг 1), передача сведений контрагента в загруженный шаблон обработки данных Excel (шаг 2).

## Изобретение велосипеда
Первоначально возникла потребность хранить 3 группы текстовых данных:
- сведения контрагентов:
  - идентификатор контрагента (ключевое слово)
  - наименование краткое;
  - ИНН;
  - юридический адрес;
- средства измерений:
  - наименование полное;
  - тип (аббревиатура);
  - регистрационный номер (является идентификатором);
  - шифр и наименование документа на выполнение работ;
- эталоны и вспомогательное оборудование:
  - наименование полное;
  - регистрационный номер;
  - идентификатор;
  - сведения о сроке действия.

Впоследствии потребовалось дополнитель группы данными: 
- средства измерений:
  - набор файлов (количество произвольно), привязанный к конкретному элементу таблицы;
  - перекрёстная ссылка (указатель) на элемент таблицы, из которого следует загружать шаблоны файлов;
  - возможность поверки в ранге эталона (флаг);
- сведения исполнителей работ:
  - фамилия, имя и отчество полные;
  - дожность в подразделении;
  - право выполнять поверочные работы (флаг);
- архив выполненных работ.

Самый простой способ организации данных — таблица. Самый простой способ организации таблиц — Excel.
Каждый раз открывать книгу Excel для считывания данных ресурсозатратно (и долго), потому таблицы были перенесены в текстовые файлы.

При разработке библиотеки очень быстро пришло понимание, что ненужно создавать несколько однотипных механизмов обращения к обособленным таблицам данных, необходимо иметь единый механизм, который будет предоставлять сведения в ответ на запрос, адресованный конкретной таблице. 

## Две архитектуры библиотеки
Старая архитектура — плохая презентация: собрание WET-кода, бизнес-логика размещена в UserForm и завязана на её вызове, попытки применять systems hungarian, повсеместные public методы, а также переменные, которые многократно применяются внутри мега-класса. Это не то, что стоит показывать. Это причина построения новой архитектуры. 

Вместе с тем, золотое правило разработки — не трогать то, что работает. Прошу здесь рассматривать концепцию, а не реализацию.

Компоненты библиотеки старой архитектуры имеют префикс имени «z_...» для отображения внизу списка.
## Возможности библиотеки (старая архитектура) на примере базы данных средств измерений
Изначальная концепция  следующая. Имеется книга Excel, в которой создана форма документа для обработки данных. В этой форме присутствуют поля (ячейки), в которые независимо от типа средства измерений помещаются идентификационные данные из таблицы базы данных:

![Title](https://github.com/akolodka/VBA/blob/main/resources/protocol_fields.jpg)

Исходные задачи две:
- найти, что передавать;
- найти, куда передавать.

Пользовательская форма, вызываемая по клику на кнопку с Ribbon-меню:

![Title](https://github.com/akolodka/VBA/blob/main/resources/databaseOld_Main.jpg)



Under construction

## Конструктор файла-шаблона обработки данных в Excel
Under construction

## Возможности библиотеки (новая архитектура) на примере базы данных контрагентов
Under construction

## Установка и настройка библиотеки
Under construction

## Доступ к исходному коду из VBA IDE 
Проект библиотеки защищён паролем «1» ввиду обилия компонентов, по умолчанию отображающихся списком в IDE.
