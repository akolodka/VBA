# Менеджер идентификации работ в подразделении

Библиотека реализует третий из четырёх шагов концепции оформления результатов типовой метрологической работы: присвоение уникального идентификатора внутри отчётного файла, а также передача идентификатора в имя файла, связанного с выполняемой работой.

## Порядок присвоения идентификатора

Каждой типовой метрологической работе в подразделении должен быть присвоен идентификатор отчётной документации в формате 
```
ЛЛЛЛ/ХХХХ–ГГГГ
```
где 
- ЛЛЛЛ — номер подразделения;
- ХХХХ — порядковый номер внутри подразделения;
- ГГГГ — год на момент регистрации документов. 

Подразделение, где применяется настоящая библиотека, имеет собственный уникальный номер 210. 
Также внутри подразделения существует разделение на лаборатории: 2101, 2102, 2103, 2104.

Подразделение имеет три направления работ, для которых необходимо вести независимые порядковые внутренние номера:
- поверка;
- калибровка;
- измерения.

Для поверочных и калибровочных работ порядковые номера уникальны внутри лаборатории, для измерительной работы порядковые номера общие на всё подразделение. Для калибровочной и измерительной работы применяются дополнительные символы в идентификаторе. Ниже представлены примеры уникальных идентификаторов. 

Поверочная работа:
```
2104/0123–2023
```
Калибровочная работа:
```
RU 01 № 2104/0123–2023
```
Измерительная работа:
```
210/0123–2023–И 
```
Подразделение приняло следующую конвенцию именования файлов обработки результатов измерений по направлениям работ:
- поверочные работы должны иметь префиксы pr_, jr_ и содержать уникальный идентификатор:
```
pr_2104_0123_23.xlsx, jr_2104_0123_23.xlsx
```
- калибровочные работы должны иметь префиксы prc_, jrc_ и содержать уникальный идентификатор:
```
prс_2104_0123_23.xlsx, jrс_2104_0123_23.xlsx
```
- измерительные работы должны иметь префиксы prm_ и содержать уникальный идентификатор:
```
prm_210_0123_23.xlsx
```

Каждая лаборатория имеет свой электронный журнал регистрации поверочных работ (файл .xlsx на сервере), в котором хранится информация о выполняемой работе:
- контрагент (организация-заказчик);
- тип средства измерений;
- заводской номер;
- порядковый номер работы;
- дата поверки;
- номер документа, присвоенный федеральным информационным фондом по обеспечению единства измерений;
- исполнители работ;
- ссылка на интернет-запись о поверке.

Общий вид журнала регистрации поверочных работ:

![Title](https://github.com/akolodka/VBA/blob/main/resources/verifyingJournal.jpg)

## Область применения библиотеки

Библиотека выполняет три основные функции:
- открытие в проводнике директории активного файла Excel;
- обмен данными с файлом журнала регистрации поверок на сервере и получение идентификатора работы;
- передача идентификатора работы в тело и наименование активного файла Excel.

Также реализована вспомогательная функция присвоения имени pdf-файлу на основании  идентификационных данных работы, хранящихся в текущем файле Excel.

## Принцип работы библиотеки
Представление пользовательской формы изменяется в зависимости от типа выполняемой работы: 
- при запуске в файле Excel, не относящимся к одному из трёх типов работ:

![Title](https://github.com/akolodka/VBA/blob/main/resources/numName_MainDefault.jpg)

- при запуске в файле калибровочной работы:

![Title](https://github.com/akolodka/VBA/blob/main/resources/numName_MainCalibration.jpg)

- при запуске в файле поверочной работы:

![Title](https://github.com/akolodka/VBA/blob/main/resources/numName_MainVerifying2.jpg)

Some description could be here...

## Установка и настройка библиотеки
Some description could be here...

## Доступ к исходному коду библиотеки из VBA IDE 
Проект библиотеки защищён паролем «1» ввиду обилия компонентов, по умолчанию отображающихся списком в IDE.
