# Помощник ПКР
Группа надстроек Excel для автоматизации подготовки отчётных документов по результатам поверочных (калибровочных) работ.

Идея проекта родилась в 2017 году. Большую часть работы в любой бюджетной организации, тем более в околонаучной среде, занимает выполнение отчётной документации.
Математические операции сперва производят в Excel, затем подготавливают проекты документов к печати на бланках с уникальным регистрационным номером — в Word. 

Это сейчас как грибы после дождя получили распространение системы на базе 1С (никому не пожелаю).
А пять лет назад и ранее всё выполнялось исключительно в ручном режиме. Человеческий фактор играл наибольшее влияние в объёмах брака документов.

Главной мотивацией в развитии проекта была не леность, отнюдь. Но внутренее понимание, что в тысячный раз повторяемую мелкую операцию можно выполнять изящнее. 

## Цель
Целью, в первую очередь, было сокращние умственных издержек: внимания, эмоций и сил, расходуемых вхолостую на пустую работу (copy-paste) каждый раз.
И, как следствие, повышение качества подготовки документов, а также его сохранение при увеличении объёмов работ.

## Почему группа?
VBA — процедурный ЯП, побуждающий разработчика помещать код в длинные портянки, смешивая в кашу бизнес-логику проекта. 
Изначально проект был в одном файле надстройки, впоследствии разделение архитектуры на системы привело к выделению библиотек.

Каждая надстройка работает независимо друг от друга и имеет собственные конфигурационные файлы, которые размещаются в едином каталоге: 
```
%appdata%\Помощник ПКР\config\
```
Файлы с кешем данных библиотек хранятся в едином каталоге:
```
%appdata%\Помощник ПКР\cache\
```

## Возможности
Решаемые проектом задачи:
- быстрый и удобный централизованный доступ к сведениям контрагентов (наименование, инн, юридический адрес), средств измерений (наименование, тип, регистрационный номер, наименование и шифр документа на проведение работ), персонала, участвующего в работах (ФИО, должности), архив выполненных работ;
- передача в документ (нужную ячейку, имя файла и свойство) стандартизованного номера — идентификатора работы;
- перенос конкретных полей из расчётного excel-файла в проект документа word;
- экспорт документов на сервер (в том числе с конвертацией в pdf);
- расширение возможностей функций Excel пользовательскими функциями (UDF);
- автообновление установленных библиотек в фоновом режиме.
Более подробное описание назначения конкретных библиотек приведено в соответствующих README настоящего репозитория.

## Требования к ПО и установка 

Проект работает в любой версии Excel, однако Ribbon-меню построено на customUI14.xml, что требует Office 2010 и новее.
При разработке использован минимум сторонних com-библиотек (references).

В резозитории представлена часть надстроек ввиду специфичности их применения.
Для установки библиотеки скопировать интересующий файл helper_**.xlam в каталог: 
```
%appdata%\Microsoft\Excel\XLSTART\
```

## Ribbon-меню при установке полного пакета надстроек

![Title](https://github.com/akolodka/VBA/blob/main/resources/helper_ribbonMenu.png)

## Доступ к исходному коду проектов 
По умолчанию проекты защищены паролем «1». Это сделано ввиду обилия компонентов, по умолчанию раскрывающихся в IDE.
