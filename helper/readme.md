# Помощник ПКР
Группа надстроек Excel для автоматизации выполнения отчётных документов по результатам поверочных (калибровочных) работ.

Идея проекта родилась в 2017 году. Большую часть работы в любой бюджетной организации, тем более в околонаучной среде, занимает оформление отчётной документации.
Математические операции сперва производят в Excel, затем подготавливают проекты документов к печати на бланках с уникальным регистрационным номером — в Word. 

Сейчас получили широкое распространение системы на базе 1С. Пять лет назад (тем более ранее) всё выполнялось исключительно вручную. Человеческий фактор играл наибольшую роль в объёмё брака документов.

Главной мотивацией в развитии проекта была не леность, но внутренее понимание, что в тысячный раз повторяемую мелкую операцию можно выполнять программными средствами, а полезную мыслительную деятельность направить на решение сложных задач. 

Проект создан и поддерживается единственным разработчиком.

## Цель
Целью, в первую очередь, было сокращние умственных издержек: внимания, эмоций и сил, расходуемых вхолостую на пустую работу (copy-paste) каждый раз.
И, как следствие, повышение качества подготовки документов, а также его сохранение при увеличении объёмов работ.

## Почему группа?
VBA — процедурный ЯП, побуждающий разработчика помещать код на длинную простыню, смешивая в кашу бизнес-логику проекта. 
Изначально проект был в одном файле надстройки, впоследствии разделение архитектуры на системы привело к выделению библиотек.

Каждая надстройка работает независимо друг от друга и имеет собственные конфигурационные файлы, которые размещаются в едином каталоге: 
```
%appdata%\Помощник ПКР\config\
```
Файлы с кешем данных библиотек хранятся в едином каталоге:
```
%appdata%\Помощник ПКР\cache\
```

## Возможности

Группа библиотек реализует концепцию четырёх шагов выполнения типовой задачи по подготовке комплекта документов:
- загрузка шаблона — документа Excel для выполнения расчётов в отношении конкретного прибора;
- передача в документ Excel сведений контрагента (организация — заказчик работ);
- передача в документ Excel номера — идентификатора работы (и переименование документа согласно номеру);
- перенос данных из документа Excel в шаблон — документ Word.

Решаемые проектом задачи:
- быстрый и централизованный доступ к сведениям контрагентов (наименование, инн, юридический адрес), средств измерений (наименование, тип, регистрационный номер, наименование и шифр документа на проведение работ), персонала, участвующего в работах (ФИО, должности), архив выполненных работ;
- передача в документ (нужную ячейку, имя файла и свойство) стандартизованного номера — идентификатора работы;
- перенос конкретных полей из расчётного excel-файла в проект документа word;
- экспорт документов на сервер (в том числе с конвертацией в pdf);
- расширение возможностей операций над ячейками Excel пользовательскими функциями (UDF);
- автообновление установленных библиотек в фоновом режиме без прав администратора.

Более подробное описание назначения конкретных библиотек приведено в соответствующих README настоящего репозитория.

## Требования к ПО и установка 

Проект работает в любой версии Excel, однако Ribbon-меню построено на customUI14.xml, что требует Office 2010 и новее.
При разработке использован минимум сторонних com-библиотек.

В резозитории представлена только часть надстроек ввиду специфичности их применения.
Для установки библиотеки скопировать интересующий файл helper_**.xlam в каталог: 
```
%appdata%\Microsoft\Excel\XLSTART\
```
Доступ к функциям библиотек осуществляется через выделенную вкладку на ленте «Помощник ПКР».
Конфигурация конкретных библиотек производится через выпадающее меню «Настройки».

## Ribbon-меню при установке полного пакета библиотек

![Title](https://github.com/akolodka/VBA/blob/main/resources/helper_ribbonMenu.png)

## Доступ к исходному коду библиотек из VBA IDE 
Проект каждой библиотеки защищён паролем «1» ввиду обилия компонентов, по умолчанию отображающихся списком в IDE.
