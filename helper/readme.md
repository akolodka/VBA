# Помощник ПКР
Группа надстроек Excel для автоматизации выполнения отчётных документов по результатам поверочных (калибровочных) работ.

Идея проекта родилась в 2017 году. Большую часть работы в любой бюджетной организации, тем более в околонаучной среде, занимает оформление отчётной документации.
Математические операции сперва производят в Excel, затем подготавливают проекты документов к печати на бланках с уникальным регистрационным номером — в Word. 

Группа библиотек реализует концепцию четырёх шагов оформления результатов типовой метрологической работы (подготовки комплекта отчётных документов):
- загрузка шаблона — документа Excel для выполнения расчётов в отношении конкретного проверяемого прибора / радионуклидного источника;
- передача в документ Excel сведений контрагента (организация — заказчик работ);
- передача в документ Excel номера — идентификатора работы (и переименование документа согласно номеру);
- перенос данных из документа Excel в шаблон — документ Word.

Проект создан и поддерживается единственным разработчиком.

## Почему группа?
VBA — процедурный ЯП, побуждающий разработчика помещать код на длинную простыню, смешивая в кашу бизнес-логику проекта. 
Изначально проект был в одном файле надстройки, впоследствии разделение архитектуры на системы привело к выделению библиотек.

Каждая надстройка работает независимо друг от друга и имеет собственные конфигурационные файлы, которые размещаются в едином каталоге: 
```
%appdata%\Помощник ПКР\config\
```
Файлы с кешем данных библиотек хранятся в едином каталоге:
```
%appdata%\Помощник ПКР\cache\
```

## Возможности

Решаемые проектом задачи:
- быстрый и централизованный доступ к сведениям контрагентов (наименование, инн, юридический адрес), средств измерений (наименование, тип, регистрационный номер, наименование и шифр документа на проведение работ), персонала, участвующего в работах (ФИО, должности), архив выполненных работ;
- передача в документ (нужную ячейку, имя файла и свойство) стандартизованного номера — идентификатора работы;
- перенос данных через таблицу «ключ-значение» в документ word;
- экспорт (копирование) пакета документов в нужный каталог в зависимости от расширения файлов (в том числе с конвертацией в pdf);
- применение пользовательских функций (UDF) для упрощения доступа к специфичным формулам (радиоактивный распад, правильное округление значений);
- автообновление установленных библиотек в фоновом режиме без прав администратора.

Более подробное описание конкретных библиотек приведено в соответствующих readme настоящего репозитория.

## Требования к ПО и установка 

Ribbon-меню библиотек построено на customUI14.xml, что требует Office 2010 и новее.

Для установки библиотеки скопировать интересующий файл helper_**.xlam в каталог: 
```
%appdata%\Microsoft\Excel\XLSTART\
```
Доступ к функциям библиотек осуществляется через выделенную вкладку на ленте «Помощник ПКР».
Конфигурация конкретных библиотек производится через выпадающее меню «Настройки».

## Ribbon-меню при установке полного пакета библиотек

![Title](https://github.com/akolodka/VBA/blob/main/resources/helper_ribbonMenu.png)

## Доступ к исходному коду библиотек из VBA IDE 
Проект каждой библиотеки защищён паролем «1» ввиду обилия компонентов, по умолчанию отображающихся списком в IDE.
